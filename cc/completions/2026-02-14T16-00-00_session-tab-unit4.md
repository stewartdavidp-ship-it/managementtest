---
task: "Landing Page Session Cards & Session History Enrichment"
status: complete
cc-spec-id: sp_session_tab_unit4
files:
  - path: "index.html"
    action: modified
commits:
  - "73a784e"
odrc:
  new_decisions:
    - "IdeaWorkCard dual-state rendering: active sessions show green glow border with staleness indicators, pending ideas show phase-colored stripe with session count"
    - "Active-first sorting in getRecentIdeas — ideas with active sessions pin to top, then by recency"
    - "workCardUploadResults opens native file picker and routes through existing handleFileDrop pipeline via e.target.files"
    - "buildSessionPackageSignatures is a stub — directory watching via File System Access API not yet implemented"
    - "Session history enrichment is additive — existing sessions without chain/debrief/phase fields display unchanged"
  resolved_opens: []
  new_opens:
    - "Should session package detection become active polling when File System Access API is implemented?"
    - "Should the Upload Results file picker pre-filter to the active session's expected zip filename?"
unexpected_findings: []
unresolved: []
---

## Approach

Implemented the spec's five phases (A-E): formatTimeAgo utility and getRecentIdeas rewrite, IdeaWorkCard dual-state component, DashboardView handler integration, session package detection stub, and session history enrichment in IdeasView.

## Implementation

- **Phase A:** Added `formatTimeAgo()` utility near `generateSessionId()`. Rewrote `getRecentIdeas()` with active-first sorting (withSession pinned to top), maxCount increased to 8, session lifecycle enrichment fields (sessionState, activeSessionId, activeSessionCreatedAt, briefDownloaded, staleDays).
- **Phase B:** Added `STALE_WARNING_DAYS = 7` and `STALE_ESCALATED_DAYS = 14` constants. Rewrote `IdeaWorkCard` to dual-state with props `{ idea, onNavigateIdea, onNavigateApp, onContinue, onUploadResults, onAbandon }`. Active cards: green glow, staleness escalation (amber/red), Upload Results button. Stale cards: Abandon button. Pending cards: phase-colored stripe, Continue button.
- **Phase C:** Added `workCardUploadResults` handler (file picker routing through `onFileDrop`), `workCardAbandon` handler (calls `IdeaManager.abandonSession`). Updated section header "Recent Work" to "Active Work". Passed `onUploadResults` and `onAbandon` props to IdeaWorkCard.
- **Phase D:** Added `buildSessionPackageSignatures()` function with TODO comment for future File System Access API integration. No active polling — stub only.
- **Phase E:** Enriched session history rendering in IdeasView idea-detail mode with chain metadata (link count, concept blocks, elapsed time), collapsible debrief summary, next session hint, phase transition display, and abandoned status badge.

## Verification

- Version bumped to 8.68.0
- 180 lines added across 5 phases
- All changes in single index.html file
- Existing session log entries without enrichment fields display unchanged
